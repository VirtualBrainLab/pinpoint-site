---
import Article from "../components/Article.astro";
import TwoColumn from "../components/TwoColumn.astro";
import Layout from "../layouts/Layout.astro";
import {Image} from "astro:assets"

import Graphics from "../components/Graphics.astro";
import GraphicsImporter from "../scripts/graphics-importer";
import type {DefaultImageMetadata} from "../scripts/types";

// Import static images.
import MPMRig from "../assets/manipulators/mpm-rig.avif";
import SensapexRig from "../assets/manipulators/sensapex-rig.avif";


// Import graphics.
const introImporter = new GraphicsImporter(
    import.meta.glob<DefaultImageMetadata>("/src/assets/intro/*.avif"),
);
const equipmentImporter = new GraphicsImporter(
    import.meta.glob<DefaultImageMetadata>("/src/assets/equipment/*.avif"),
);
const insertionImporter = new GraphicsImporter(
    import.meta.glob<DefaultImageMetadata>("/src/assets/insertion/*.avif"),
);
---

<Layout imageSrcs={[introImporter.getImageSrcs(), equipmentImporter.getImageSrcs(), insertionImporter.getImageSrcs()]}>
    <!-- Pinpoint Intro Sequence. -->
    <TwoColumn>
        <Graphics imageMetadatas={introImporter.getImageMetadatas()} slot="graphics"/>

        <!-- Titles. -->
        <div class="flex justify-center items-center h-dvh">
            <div class="flex-col">
                <Article>
                    <h1 class="text-primary">Pinpoint</h1>
                    <h3>Interactive 3D visualization and automation tools for human neuroscience research and
                        neurosurgery.</h3>
                </Article>

                <br/>

                <div>
                    <a class="btn btn-primary" href="https://data.virtualbrainlab.org/Pinpoint/">Launch</a>
                    <a class="btn" href="#goal">Learn More</a>
                </div>
            </div>
        </div>

        <!-- Goal. -->
        <div>
            <span class="anchor" id="goal"></span>
            <Article>
                <h1>Pinpoint aims to advance large-scale neuroscience research with intuitive browser-based
                    planning and
                    automation tools for efficient and reproducible neurosurgery.
                </h1>
            </Article>
        </div>

        <!-- Problem statement. -->
        <div class="flex justify-center items-center h-dvh">
            <Article>
                <h2>Human behavior engage multiple regions of the brain.</h2>
                <h3>Current tools are designed to study individual brain regions, depend on manual input, and
                    require extensive expertise to operate.</h3>
                <p>Modern neuroscientists need tools that enable the study of the whole brain to better
                    understand
                    human behavior and cure neurodegenerative diseases that affect the whole brain like
                    Parkinson's
                    and Alzheimer's.</p>
            </Article>
        </div>
    </TwoColumn>

    <!-- Planning Phase. -->

    <div class="hero">
        <div class="hero-content">
            <Article>
                <h1 class="text-center">Plan Your Next Surgery with<br/><span class="text-primary">Pinpoint</span></h1>
            </Article>
        </div>
    </div>

    <!-- Simulate Equipment. -->
    <TwoColumn>
        <Graphics imageMetadatas={equipmentImporter.getImageMetadatas()} slot="graphics"/>

        <div class="h-1/3dvh"/>
        <div class="h-3/2dvh">
            <div class="sticky top-1/3">
                <Article>
                    <h2>Simulate your equipment</h2>
                    <h3>Pinpoint includes electrophysiology probes, viral injectors, 2-photon lasers, and pipettes.</h3>
                    <p>Custom equipment can be added as well.</p>
                </Article>
            </div>
        </div>
        <div class="h-1/2dvh"/>
    </TwoColumn>

    <!-- Make complex plans with ease. -->
    <TwoColumn>
        <Graphics imageMetadatas={insertionImporter.getImageMetadatas()} slot="graphics"/>

        <div class="h-1/3dvh"/>
        <div class="h-3/2dvh">
            <div class="sticky top-1/3">
                <Article>
                    <h2>See the brain in detail</h2>
                    <h3>Get exact surface coordinates, accessed brain regions, and planar slices.</h3>
                </Article>
            </div>
        </div>
        <div class="h-1/2dvh"/>
    </TwoColumn>

    <!-- Automation Phase -->

    <div class="hero">
        <div class="hero-content">
            <Article>
                <h1 class="text-center">Run Your Plan with<br/><span class="text-primary">Pinpoint Automation</span>
                </h1>
            </Article>
        </div>
    </div>

    <TwoColumn>
        <div class="h-3/2dvh">
            <Article>
                <h2>Let the robots do the heavy lifting</h2>
                <h3>Pinpoint can control neurosurgery robotic manipulators to automatically run your plans.</h3>
                <p>Below: Sensapex Multiprobe <span class="italic">in vivo</span> rig and New Scale MPM rig.</p>
                <Image class="rounded-xl w-3/4" src={SensapexRig} alt="Sensapex Rig"/>
                <Image class="rounded-xl w-3/4" src={MPMRig} alt="MPM Rig"/>
            </Article>
        </div>
    </TwoColumn>
</Layout>

<style>
    .anchor {
        display: block;
        height: 45dvh;
        margin-top: -45dvh;
        visibility: hidden;
    }
</style>